import{d as k,l as F,s as S,r as x,c as V,y as A,o as p,a as v,b as e,t as a,f as C,w as u,v as c,C as T,B as _,F as U,e as E,n as L}from"./index-bf582a4f.js";const M={class:"space-y-6"},B={class:"glass-panel space-y-4"},P={class:"section-heading"},q={key:0,class:"rounded-2xl border border-red-100 bg-red-50/70 px-4 py-2 text-sm text-red-700"},W={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},$={class:"flex gap-2"},j={class:"glass-panel space-y-5"},I={class:"flex flex-wrap items-center gap-3 justify-between"},O={class:"section-heading"},z={class:"flex items-center gap-2"},J={class:"grid grid-cols-1 gap-4 sm:grid-cols-3"},R={class:"rounded-2xl border border-transparent bg-blue-50/70 p-4"},G={class:"mt-2 text-2xl font-bold text-blue-900"},H={class:"rounded-2xl border border-transparent bg-orange-50/80 p-4"},K={class:"mt-2 text-2xl font-bold text-orange-800"},Q={class:"rounded-2xl border border-transparent bg-emerald-50/80 p-4"},X={class:"mt-2 text-2xl font-bold text-emerald-700"},Y={class:"overflow-hidden rounded-2xl border border-slate-100"},Z={class:"max-h-[520px] overflow-auto"},ee={class:"table-modern"},te={key:0},le={class:"font-semibold text-slate-900"},se={class:"text-right font-semibold text-slate-900"},oe={class:"text-center"},ae={class:"inline-flex gap-2"},ne=["onClick"],de=["onClick"],ue=k({__name:"CustomerAdmin",setup(ie){const d=F(),s=S({fullName:"",phone:"",email:"",address:""}),r=x(null),f=x(""),m=x("all"),i=x(""),b=V(()=>{let o=d.customersForCurrentStore;const t=f.value.trim().toLowerCase();return t&&(o=o.filter(l=>{var n,h;return l.fullName.toLowerCase().includes(t)||l.phone.includes(t)||((n=l.email)==null?void 0:n.toLowerCase().includes(t))||((h=l.address)==null?void 0:h.toLowerCase().includes(t))})),m.value==="with-dues"?o=o.filter(l=>l.totalDue>0):m.value==="no-dues"&&(o=o.filter(l=>l.totalDue===0)),o.sort((l,n)=>l.fullName.localeCompare(n.fullName))});function g(){s.fullName="",s.phone="",s.email="",s.address="",r.value=null,i.value=""}function y(){var o,t,l,n;if(!s.fullName.trim()||!s.phone.trim()){i.value="Name and phone are required";return}if(!/^[0-9+\-\s()]+$/.test(s.phone.trim())){i.value="Invalid phone number format";return}try{r.value==null?d.add({fullName:s.fullName.trim(),phone:s.phone.trim(),email:((o=s.email)==null?void 0:o.trim())||void 0,address:((t=s.address)==null?void 0:t.trim())||void 0}):d.update(r.value,{fullName:s.fullName.trim(),phone:s.phone.trim(),email:((l=s.email)==null?void 0:l.trim())||void 0,address:((n=s.address)==null?void 0:n.trim())||void 0}),g(),i.value=""}catch(h){i.value=h.message||"Failed to save customer"}}function N(o){r.value=o.id,s.fullName=o.fullName,s.phone=o.phone,s.email=o.email||"",s.address=o.address||"",i.value=""}function D(o){confirm("Delete this customer? This will also remove their purchase history.")&&(d.remove(o),r.value===o&&g())}function w(){f.value="",m.value="all"}return A(()=>{d.load()}),(o,t)=>(p(),v("div",M,[e("div",B,[e("h2",P,a(r.value==null?"Add Customer":"Edit Customer"),1),i.value?(p(),v("div",q,a(i.value),1)):C("",!0),e("div",W,[e("div",null,[t[6]||(t[6]=e("label",{class:"subtle-label"},"Full Name *",-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>s.fullName=l),type:"text",placeholder:"John Doe",class:"input-field"},null,512),[[c,s.fullName]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"subtle-label"},"Phone *",-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>s.phone=l),type:"tel",placeholder:"+1234567890",class:"input-field"},null,512),[[c,s.phone]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"subtle-label"},"Email (Optional)",-1)),u(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.email=l),type:"email",placeholder:"john@example.com",class:"input-field"},null,512),[[c,s.email]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"subtle-label"},"Address (Optional)",-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>s.address=l),type:"text",placeholder:"123 Main St, City",class:"input-field"},null,512),[[c,s.address]])])]),e("div",$,[e("button",{onClick:y,class:"btn-primary text-white"},a(r.value==null?"Add Customer":"Save Changes"),1),e("button",{onClick:g,class:"btn-ghost"},"Clear")])]),e("div",j,[e("div",I,[e("h2",O,"Customers ("+a(b.value.length)+")",1),e("div",z,[u(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>m.value=l),class:"input-field w-28 text-xs"},[...t[10]||(t[10]=[e("option",{value:"all"},"All",-1),e("option",{value:"with-dues"},"With Dues",-1),e("option",{value:"no-dues"},"No Dues",-1)])],512),[[T,m.value]]),e("button",{onClick:w,class:"btn-ghost text-xs px-2"},"Reset"),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>f.value=l),type:"search",placeholder:"Search...",class:"input-field w-32 ml-4 text-xs",style:{"margin-left":"auto"}},null,512),[[c,f.value]])])]),e("div",J,[e("div",R,[t[11]||(t[11]=e("div",{class:"subtle-label"},"Total Customers",-1)),e("div",G,a(_(d).totalCustomers),1)]),e("div",H,[t[12]||(t[12]=e("div",{class:"subtle-label"},"Total Dues",-1)),e("div",K,"₹"+a(_(d).totalDues.toFixed(2)),1)]),e("div",Q,[t[13]||(t[13]=e("div",{class:"subtle-label"},"With Dues",-1)),e("div",X,a(_(d).customersWithDues.length),1)])]),e("div",Y,[e("div",Z,[e("table",ee,[t[15]||(t[15]=e("thead",null,[e("tr",null,[e("th",null,"Name"),e("th",null,"Phone"),e("th",null,"Email"),e("th",{class:"text-right"},"Total Purchases"),e("th",{class:"text-right"},"Total Due"),e("th",{class:"text-center"},"Actions")])],-1)),e("tbody",null,[b.value.length===0?(p(),v("tr",te,[...t[14]||(t[14]=[e("td",{colspan:"6",class:"text-center text-slate-400"},"No customers found",-1)])])):C("",!0),(p(!0),v(U,null,E(b.value,l=>(p(),v("tr",{key:l.id},[e("td",le,a(l.fullName),1),e("td",null,a(l.phone),1),e("td",null,a(l.email||"-"),1),e("td",se," ₹"+a(l.totalPurchases.toFixed(2)),1),e("td",{class:L(["text-right font-semibold",l.totalDue>0?"text-red-600":"text-emerald-600"])}," ₹"+a(l.totalDue.toFixed(2)),3),e("td",oe,[e("div",ae,[e("button",{onClick:n=>N(l),class:"btn-ghost text-xs px-3 py-1"},"Edit",8,ne),e("button",{onClick:n=>D(l.id),class:"btn-danger text-xs px-3 py-1"},"Delete",8,de)])])]))),128))])])])])])]))}});export{ue as default};
