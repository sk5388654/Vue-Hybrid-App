import{d as D,c as U,y as k,o as u,a as r,b as t,f as g,t as s,F as P,e as L,B as w,r as _,I,g as V}from"./index-64b2fb6b.js";import{_ as j}from"./BarcodeDisplay.vue_vue_type_script_setup_true_lang-89931c48.js";import{_ as M}from"./_plugin-vue_export-helper-c27b6911.js";import{e as S,p as F}from"./print-175f5ba3.js";const $={id:"invoice-print",class:"mx-auto w-full max-w-2xl rounded-lg bg-white p-6 text-slate-100 print:rounded-none print:p-0"},C={class:"flex items-center gap-3 border-b pb-4"},R=["src"],A={class:"text-lg font-semibold"},B={class:"text-xs text-slate-400"},O={class:"ml-auto text-right text-sm text-slate-300"},z={key:0},E={class:"mt-4 overflow-hidden rounded border"},K={class:"min-w-full divide-y divide-gray-200 text-sm"},q={class:"divide-y divide-gray-100"},G={class:"px-3 py-2"},Q={class:"px-3 py-2 text-right"},W={class:"px-3 py-2 text-right"},X={class:"px-3 py-2 text-right"},H={class:"px-3 py-2 text-right"},J={class:"mt-4 space-y-1 text-sm"},Y={class:"flex items-center justify-between"},Z={class:"font-medium text-slate-100"},tt={class:"flex items-center justify-between"},et={class:"font-medium text-slate-100"},ot={class:"flex items-center justify-between"},st={class:"text-slate-300"},it={class:"font-medium text-slate-100"},nt={class:"flex items-center justify-between"},at={class:"font-medium text-slate-100"},ct={class:"flex items-center justify-between text-base font-semibold"},lt={class:"mt-4 flex items-center justify-center"},dt=D({__name:"InvoicePrint",props:{shopName:{},shopLogoUrl:{},invoiceNumber:{},datetime:{},items:{},subtotal:{},productDiscountTotal:{},invoiceDiscountMode:{},invoiceDiscountValue:{},invoiceDiscountAmount:{},total:{},paymentType:{},cashier:{},customerName:{}},setup(e,{expose:v}){const i=e,m=U(()=>i.total);return k(()=>{}),v({async getBarcodePngDataUrl(){const c=document.querySelector("#invoice-print svg");if(!c)return;const o=new XMLSerializer().serializeToString(c),a=new Blob([o],{type:"image/svg+xml;charset=utf-8"}),l=URL.createObjectURL(a),n=new Image,x=await new Promise(N=>{n.onload=function(){var f,p,y,b;const d=document.createElement("canvas");d.width=((p=(f=c.width)==null?void 0:f.baseVal)==null?void 0:p.value)||300,d.height=((b=(y=c.height)==null?void 0:y.baseVal)==null?void 0:b.value)||80;const h=d.getContext("2d");h.fillStyle="#fff",h.fillRect(0,0,d.width,d.height),h.drawImage(n,0,0);const T=d.toDataURL("image/png");N(T)},n.src=l});return URL.revokeObjectURL(l),x}}),(c,o)=>(u(),r("div",$,[t("div",C,[e.shopLogoUrl?(u(),r("img",{key:0,src:e.shopLogoUrl,alt:"logo",class:"h-10 w-10 rounded object-cover"},null,8,R)):g("",!0),t("div",null,[t("div",A,s(e.shopName||"Shop POS"),1),t("div",B,"Invoice #"+s(e.invoiceNumber),1)]),t("div",O,[t("div",null,s(new Date(e.datetime).toLocaleString()),1),e.customerName?(u(),r("div",z,"Customer: "+s(e.customerName),1)):g("",!0),t("div",null,"Cashier: "+s(e.cashier),1)])]),t("div",E,[t("table",K,[o[0]||(o[0]=t("thead",{class:"dark-panel"},[t("tr",null,[t("th",{class:"px-3 py-2 text-left font-medium text-slate-200"},"Item"),t("th",{class:"px-3 py-2 text-right font-medium text-slate-200"},"Qty"),t("th",{class:"px-3 py-2 text-right font-medium text-slate-200"},"Unit"),t("th",{class:"px-3 py-2 text-right font-medium text-slate-200"},"Discount"),t("th",{class:"px-3 py-2 text-right font-medium text-slate-200"},"Total")])],-1)),t("tbody",q,[(u(!0),r(P,null,L(e.items,(a,l)=>(u(),r("tr",{key:l},[t("td",G,s(a.name),1),t("td",Q,s(a.quantity),1),t("td",W,"₹"+s(a.unitPrice.toFixed(2)),1),t("td",X,"₹"+s(a.lineDiscount.toFixed(2)),1),t("td",H,"₹"+s(a.lineTotal.toFixed(2)),1)]))),128))])])]),t("div",J,[t("div",Y,[o[1]||(o[1]=t("span",{class:"text-slate-300"},"Subtotal",-1)),t("span",Z,"₹"+s(e.subtotal.toFixed(2)),1)]),t("div",tt,[o[2]||(o[2]=t("span",{class:"text-slate-300"},"Product Discounts",-1)),t("span",et,"₹"+s(e.productDiscountTotal.toFixed(2)),1)]),t("div",ot,[t("span",st," Invoice Discount ("+s(e.invoiceDiscountMode==="percent"?`${e.invoiceDiscountValue}%`:`₹${e.invoiceDiscountValue.toFixed(2)}`)+") ",1),t("span",it,"₹"+s(e.invoiceDiscountAmount.toFixed(2)),1)]),t("div",nt,[o[3]||(o[3]=t("span",{class:"text-slate-300"},"Payment",-1)),t("span",at,s(e.paymentType),1)]),t("div",ct,[o[4]||(o[4]=t("span",null,"Grand Total",-1)),t("span",null,"₹"+s(m.value.toFixed(2)),1)])]),t("div",lt,[w(j,{ref:"barcodeSvgRef",value:e.invoiceNumber},null,8,["value"])]),o[5]||(o[5]=t("div",{class:"mt-6 text-center text-sm text-slate-300"},"Thank you for your purchase!",-1))]))}});const ut=M(dt,[["__scopeId","data-v-45bc3e80"]]),rt=["onKeydown"],mt={class:"w-full max-w-3xl rounded-lg dark-panel"},vt={class:"flex items-center justify-between border-b px-4 py-3"},xt={class:"max-h-[70vh] overflow-auto p-4"},ht={class:"flex justify-end gap-2 border-t px-4 py-3"},gt=D({__name:"InvoiceModal",props:{shopName:{},shopLogoUrl:{},invoiceNumber:{},datetime:{},items:{},subtotal:{},productDiscountTotal:{},invoiceDiscountMode:{},invoiceDiscountValue:{},invoiceDiscountAmount:{},total:{},paymentType:{},cashier:{},customerName:{}},emits:["close"],setup(e,{emit:v}){const i=e,m=v,c=_(null);async function o(){var n;const l=await((n=c.value)==null?void 0:n.getBarcodePngDataUrl());S({shopName:i.shopName||"Shop POS",invoiceNumber:i.invoiceNumber,datetime:i.datetime,items:i.items,subtotal:i.subtotal,productDiscountTotal:i.productDiscountTotal,invoiceDiscountMode:i.invoiceDiscountMode,invoiceDiscountValue:i.invoiceDiscountValue,invoiceDiscountAmount:i.invoiceDiscountAmount,total:i.total,paymentType:i.paymentType,cashier:i.cashier,customerName:i.customerName,barcodeDataUrl:l})}function a(){F()}return(l,n)=>(u(),r("div",{class:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",onKeydown:I(V(a,["ctrl","prevent","stop"]),["p"])},[t("div",mt,[t("div",vt,[n[2]||(n[2]=t("h3",{class:"text-base font-semibold text-slate-100"},"Invoice",-1)),t("button",{class:"text-slate-400 hover:text-slate-200",onClick:n[0]||(n[0]=x=>m("close"))},"✕")]),t("div",xt,[w(ut,{ref_key:"printRef",ref:c,shopName:e.shopName,shopLogoUrl:e.shopLogoUrl,invoiceNumber:e.invoiceNumber,datetime:e.datetime,items:e.items,subtotal:e.subtotal,productDiscountTotal:e.productDiscountTotal,invoiceDiscountMode:e.invoiceDiscountMode,invoiceDiscountValue:e.invoiceDiscountValue,invoiceDiscountAmount:e.invoiceDiscountAmount,total:e.total,paymentType:e.paymentType,cashier:e.cashier,customerName:e.customerName},null,8,["shopName","shopLogoUrl","invoiceNumber","datetime","items","subtotal","productDiscountTotal","invoiceDiscountMode","invoiceDiscountValue","invoiceDiscountAmount","total","paymentType","cashier","customerName"])]),t("div",ht,[t("button",{class:"rounded-md border border-[rgba(255,255,255,0.06)] px-4 py-2 text-sm text-slate-200 hover:dark-panel",onClick:n[1]||(n[1]=x=>m("close"))},"Close"),t("button",{class:"rounded-md border border-[rgba(255,255,255,0.06)] px-4 py-2 text-sm",onClick:o},"Download PDF"),t("button",{class:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-medium text-white",onClick:a},"Print Invoice")])])],40,rt))}});export{gt as _};
