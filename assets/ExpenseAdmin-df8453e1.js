import{d as U,H as V,J as F,y as M,s as L,r as g,c as N,o as u,a as r,b as e,t as o,w as a,v as p,C as k,F as w,e as T,f as A,n as I}from"./index-406b3c36.js";const R={class:"space-y-6"},q={class:"glass-panel space-y-4"},H={class:"section-heading"},O={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},$=["value"],j={class:"sm:col-span-2"},z={class:"flex gap-2"},J={class:"glass-panel space-y-5"},P={class:"flex flex-wrap items-center gap-3 justify-between"},G={class:"flex items-center gap-2"},K=["value"],Q={class:"overflow-hidden rounded-2xl border border-slate-100"},W={class:"max-h-[520px] overflow-auto"},X={class:"table-modern"},Y={key:0},Z={class:"font-semibold text-slate-900"},ee={class:"text-right font-semibold text-red-500"},te={class:"text-center"},le={class:"inline-flex gap-2"},se=["onClick"],ne=["onClick"],oe={key:0},ae={class:"text-right text-lg font-bold text-red-500"},ue=U({__name:"ExpenseAdmin",setup(ie){var S;const x=V(),b=F();M(()=>{x.load()});const h=["Rent","Supplies","Utilities","Salary","Misc"],s=L({expenseTitle:"",expenseCategory:"Misc",amount:0,date:new Date().toISOString().split("T")[0],notes:"",addedBy:((S=b.user)==null?void 0:S.username)||""}),d=g(null),f=g(""),m=g("All"),v=g(""),c=g(""),y=N(()=>{let n=x.expensesForCurrentStore;const l=f.value.trim().toLowerCase();return l&&(n=n.filter(t=>{var i;return t.expenseTitle.toLowerCase().includes(l)||((i=t.notes)==null?void 0:i.toLowerCase().includes(l))||t.addedBy.toLowerCase().includes(l)})),m.value!=="All"&&(n=n.filter(t=>t.expenseCategory===m.value)),v.value&&(n=n.filter(t=>t.date>=v.value)),c.value&&(n=n.filter(t=>t.date<=c.value)),n.sort((t,i)=>new Date(i.date).getTime()-new Date(t.date).getTime())});function C(){var n;s.expenseTitle="",s.expenseCategory="Misc",s.amount=0,s.date=new Date().toISOString().split("T")[0],s.notes="",s.addedBy=((n=b.user)==null?void 0:n.username)||"",d.value=null}function D(){var n;if(!s.expenseTitle.trim()||s.amount<=0){alert("Please fill in title and amount (must be > 0)");return}d.value==null?x.add({...s,addedBy:((n=b.user)==null?void 0:n.username)||"admin"}):x.update(d.value,{expenseTitle:s.expenseTitle,expenseCategory:s.expenseCategory,amount:s.amount,date:s.date,notes:s.notes}),C()}function _(n){d.value=n.id,s.expenseTitle=n.expenseTitle,s.expenseCategory=n.expenseCategory,s.amount=n.amount,s.date=n.date,s.notes=n.notes||"",s.addedBy=n.addedBy}function B(n){confirm("Delete this expense?")&&(x.remove(n),d.value===n&&C())}function E(){f.value="",m.value="All",v.value="",c.value=""}return(n,l)=>(u(),r("div",R,[e("div",q,[e("h2",H,o(d.value==null?"Add Expense":"Edit Expense"),1),e("div",O,[e("div",null,[l[9]||(l[9]=e("label",{class:"subtle-label"},"Expense Title *",-1)),a(e("input",{"onUpdate:modelValue":l[0]||(l[0]=t=>s.expenseTitle=t),type:"text",class:"input-field",placeholder:"e.g. Electricity bill"},null,512),[[p,s.expenseTitle]])]),e("div",null,[l[10]||(l[10]=e("label",{class:"subtle-label"},"Category *",-1)),a(e("select",{"onUpdate:modelValue":l[1]||(l[1]=t=>s.expenseCategory=t),class:"input-field"},[(u(),r(w,null,T(h,t=>e("option",{key:t,value:t},o(t),9,$)),64))],512),[[k,s.expenseCategory]])]),e("div",null,[l[11]||(l[11]=e("label",{class:"subtle-label"},"Amount *",-1)),a(e("input",{"onUpdate:modelValue":l[2]||(l[2]=t=>s.amount=t),type:"number",min:"0.01",step:"0.01",class:"input-field"},null,512),[[p,s.amount,void 0,{number:!0}]])]),e("div",null,[l[12]||(l[12]=e("label",{class:"subtle-label"},"Date *",-1)),a(e("input",{"onUpdate:modelValue":l[3]||(l[3]=t=>s.date=t),type:"date",class:"input-field"},null,512),[[p,s.date]])]),e("div",j,[l[13]||(l[13]=e("label",{class:"subtle-label"},"Notes",-1)),a(e("textarea",{"onUpdate:modelValue":l[4]||(l[4]=t=>s.notes=t),rows:"2",placeholder:"Additional details...",class:"text-area-field"},null,512),[[p,s.notes]])])]),e("div",z,[e("button",{onClick:D,class:"btn-primary text-white"},o(d.value==null?"Add Expense":"Save Changes"),1),e("button",{onClick:C,class:"btn-ghost"},"Clear")])]),e("div",J,[e("div",P,[l[15]||(l[15]=e("h2",{class:"section-heading"},"Expense History",-1)),e("div",G,[a(e("select",{"onUpdate:modelValue":l[5]||(l[5]=t=>m.value=t),class:"input-field w-28 text-xs"},[l[14]||(l[14]=e("option",{value:"All"},"All",-1)),(u(),r(w,null,T(h,t=>e("option",{key:t,value:t},o(t),9,K)),64))],512),[[k,m.value]]),a(e("input",{"onUpdate:modelValue":l[6]||(l[6]=t=>v.value=t),type:"date",class:"input-field w-24 text-xs"},null,512),[[p,v.value]]),a(e("input",{"onUpdate:modelValue":l[7]||(l[7]=t=>c.value=t),type:"date",class:"input-field w-24 text-xs"},null,512),[[p,c.value]]),e("button",{onClick:E,class:"btn-ghost text-xs px-2"},"Reset"),a(e("input",{"onUpdate:modelValue":l[8]||(l[8]=t=>f.value=t),type:"search",placeholder:"Search...",class:"input-field w-32 ml-4 text-xs",style:{"margin-left":"auto"}},null,512),[[p,f.value]])])]),e("div",Q,[e("div",W,[e("table",X,[l[19]||(l[19]=e("thead",null,[e("tr",null,[e("th",null,"Date"),e("th",null,"Title"),e("th",null,"Category"),e("th",{class:"text-right"},"Amount"),e("th",null,"Added By"),e("th",{class:"text-center"},"Actions")])],-1)),e("tbody",null,[y.value.length===0?(u(),r("tr",Y,[...l[16]||(l[16]=[e("td",{colspan:"6",class:"text-center text-slate-400"},"No expenses found",-1)])])):A("",!0),(u(!0),r(w,null,T(y.value,t=>(u(),r("tr",{key:t.id},[e("td",null,o(new Date(t.date).toLocaleDateString()),1),e("td",Z,o(t.expenseTitle),1),e("td",null,[e("span",{class:I(["pill-badge",{"text-blue-600 border-blue-100":t.expenseCategory==="Rent","text-green-600 border-green-100":t.expenseCategory==="Supplies","text-amber-600 border-amber-100":t.expenseCategory==="Utilities","text-purple-600 border-purple-100":t.expenseCategory==="Salary","text-slate-600 border-slate-200":t.expenseCategory==="Misc"}])},o(t.expenseCategory),3)]),e("td",ee,"₹"+o(t.amount.toFixed(2)),1),e("td",null,o(t.addedBy),1),e("td",te,[e("div",le,[e("button",{onClick:i=>_(t),class:"btn-ghost text-xs px-3 py-1"},"Edit",8,se),e("button",{onClick:i=>B(t.id),class:"btn-danger text-xs px-3 py-1"},"Delete",8,ne)])])]))),128))]),y.value.length?(u(),r("tfoot",oe,[e("tr",null,[l[17]||(l[17]=e("td",{colspan:"3",class:"text-right font-semibold text-slate-600"},"Total",-1)),e("td",ae," ₹"+o(y.value.reduce((t,i)=>t+i.amount,0).toFixed(2)),1),l[18]||(l[18]=e("td",{colspan:"2"},null,-1))])])):A("",!0)])])])])]))}});export{ue as default};
